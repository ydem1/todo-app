(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{20:function(t,e,n){},22:function(t,e,n){"use strict";n.r(e);var o=n(1),c=n.n(o),r=n(9),a=(n(18),n(19),n(20),n(3)),i="https://mate.academy/students-api";function s(t){return new Promise((function(e){setTimeout(e,t)}))}function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o={method:e};return n&&(o.body=JSON.stringify(n),o.headers={"Content-Type":"application/json; charset=UTF-8"}),s(100).then((function(){return fetch(i+t,o)})).then((function(t){if(!t.ok)throw new Error;return t.json()}))}var l=function(t){return d(t)},u=function(t,e){return d(t,"POST",e)},f=function(t,e){return d(t,"PATCH",e)},j=function(t){return d(t,"DELETE")},b=function(t){var e=t.id,n=t.title,o=t.completed,c=t.userId;return f("/todos/".concat(e),{title:n,completed:o,userId:c})},p=n(0),m=[],O=c.a.createContext({todos:m,setTodos:function(){},filterOption:"all",setFilterOptions:function(){},USER_ID:11930,errorMessage:"",setErrorMessage:function(){}}),h=function(t){var e=t.children,n=Object(o.useState)(m),c=Object(a.a)(n,2),r=c[0],i=c[1],s=Object(o.useState)("all"),d=Object(a.a)(s,2),u=d[0],f=d[1],j=Object(o.useState)(""),b=Object(a.a)(j,2),h=b[0],v=b[1];Object(o.useEffect)((function(){var t;(t=11930,l("/todos?userId=".concat(t))).then(i).catch((function(){v("Unable to load todos")}))}),[]);var x=Object(o.useMemo)((function(){return{todos:r,setTodos:i,filterOption:u,setFilterOptions:f,USER_ID:11930,errorMessage:h,setErrorMessage:v}}),[r,u,h]);return Object(p.jsx)(O.Provider,{value:x,children:e})},v=n(4),x=n(2),y=n.n(x),_=function(t){var e=t.todo,n=t.deleteTodo,c=t.updatedTodo,r=Object(o.useState)(e.title),i=Object(a.a)(r,2),s=i[0],d=i[1],l=Object(o.useState)(0),u=Object(a.a)(l,2),f=u[0],j=u[1],b=Object(o.useRef)(null),m=Object(o.useContext)(O),h=m.todos,x=m.setTodos,_=m.USER_ID;Object(o.useEffect)((function(){var t;f===e.id&&(null===(t=b.current)||void 0===t||t.focus())}),[f,e.id]);var g=function(t){if(t){var o={id:e.id,title:t,userId:_,completed:e.completed},r=Object(v.a)(h),a=r.findIndex((function(t){return t.id===o.id}));r.splice(a,1,o),c(o).then((function(){x(r),j(0)}))}else{var i=h.filter((function(t){return e.id!==t.id}));n(e.id).then((function(){x(i),j(0)}))}};return Object(p.jsxs)("div",{className:y()("todo",{completed:e.completed},{editing:f===e.id}),onDoubleClick:function(){return j(e.id)},"data-cy":"Todo",children:[Object(p.jsx)("label",{className:"todo__status-label",children:Object(p.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",id:"toggle-view-".concat(e.id),onChange:function(){var t={id:e.id,title:e.title,userId:_,completed:!e.completed},n=Object(v.a)(h),o=n.findIndex((function(e){return e.id===t.id}));n.splice(o,1,t),c(t).then((function(){return x(n)}))},checked:e.completed})}),f!==e.id?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("label",{"data-cy":"TodoTitle",className:"todo__title",children:e.title}),Object(p.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDelete",onClick:function(){var t=Object(v.a)(h),o=t.findIndex((function(t){return t.id===e.id}));t.splice(o,1),n(e.id).then((function(){return x(t)}))},children:"\xd7"})]}):Object(p.jsx)("form",{onSubmit:function(t){return t.preventDefault()},children:Object(p.jsx)("input",{"data-cy":"TodoTitleField",type:"text",className:"todo__title-field",placeholder:"Empty todo will be deleted",value:s,onChange:function(t){d(t.target.value)},onBlur:function(){g(s.trim()),d(s.trim())},ref:b,onKeyPress:function(t){"Enter"===t.key&&(g(s.trim()),d(s.trim()))}})}),Object(p.jsxs)("div",{"data-cy":"TodoLoader",className:"modal overlay",children:[Object(p.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(p.jsx)("div",{className:"loader"})]})]})},g=function(){var t=Object(o.useContext)(O),e=t.todos,n=t.setErrorMessage,c=t.filterOption,r=e.filter((function(t){switch(c){case"all":return!0;case"active":return!t.completed;case"completed":return t.completed;default:return!0}})),a=function(t){return(e=t,j("/todos/".concat(e))).catch((function(t){throw n("Unable to delete a todo"),t}));var e},i=function(t){return b(t).catch((function(t){throw n("Unable to update a todo"),t}))};return Object(p.jsx)("ul",{className:"todo-list","data-cy":"todosList",children:r.map((function(t){return Object(p.jsx)(_,{todo:t,deleteTodo:a,updatedTodo:i},t.id)}))})},N=function(){return Object(p.jsx)("section",{className:"todoapp__main",children:Object(p.jsx)(g,{"data-cy":"todoList"})})},T=function(){var t=Object(o.useContext)(O),e=t.filterOption,n=t.setFilterOptions;return Object(p.jsxs)("nav",{className:"filter","data-cy":"FilterOptions",children:[Object(p.jsx)("a",{href:"#/","data-cy":"FilterOptionsLinkAll",className:y()("filter__link",{selected:"all"===e}),onClick:function(){n("all")},children:"All"}),Object(p.jsx)("a",{href:"#/active","data-cy":"FilterOptionsLinkActive",className:y()("filter__link",{selected:"active"===e}),onClick:function(){n("active")},children:"Active"}),Object(p.jsx)("a",{href:"#/completed",onClick:function(){n("completed")},"data-cy":"FilterOptionsLinkCompleted",className:y()("filter__link",{selected:"completed"===e}),children:"Completed"})]})},C=function(){var t=Object(o.useContext)(O),e=t.todos,n=t.setTodos,c=e.some((function(t){return t.completed})),r=function(t){var e=0;return t.forEach((function(t){t.completed||(e+=1)})),e}(e);return Object(p.jsxs)("footer",{"data-cy":"Footer",className:"todoapp__footer",children:[Object(p.jsx)("span",{className:"todo-count","data-cy":"TodosCounter",children:"".concat(r," item").concat(1!==r?"s":""," left")}),Object(p.jsx)(T,{}),c&&Object(p.jsx)("button",{type:"button",className:"todoapp__clear-completed","data-cy":"ClearCompletedButton",onClick:function(){var t=e.filter((function(t){return!t.completed}));n(t)},children:"Clear completed"})]})},k=n(7),E=function(){var t=Object(o.useState)(""),e=Object(a.a)(t,2),n=e[0],c=e[1],r=Object(o.useContext)(O),i=r.todos,s=r.setTodos,d=r.setErrorMessage,l=r.USER_ID,f=i.every((function(t){return t.completed})),j=Object(o.useRef)(null);return Object(o.useEffect)((function(){var t;null===(t=j.current)||void 0===t||t.focus()}),[]),Object(p.jsx)("header",{className:"todoapp__header",children:Object(p.jsxs)("form",{onSubmit:function(t){return t.preventDefault()},children:[Object(p.jsx)("button",{type:"button",className:y()("todoapp__toggle-all",{active:f}),"data-cy":"ToggleAllButton",onClick:function(){var t=i.some((function(t){return!t.completed})),e=i.map((function(e){return Object(k.a)(Object(k.a)({},e),{},{completed:t})})),n=e.map((function(t){return b(t).catch((function(t){throw t}))}));Promise.all(n).then((function(){s(e)})).catch((function(){d("Unable to update todos")}))}}),Object(p.jsx)("input",{type:"text","data-cy":"NewTodoField",className:"todoapp__new-todo",value:n,placeholder:"What needs to be done?",onChange:function(t){c(t.target.value)},onKeyPress:function(t){"Enter"===t.key&&(""===n.trim()?d("Title should not be empty"):(function(t){var e=t.title,n=t.completed,o=t.userId;return u("/todos",{title:e,completed:n,userId:o})}({title:n,completed:!1,userId:l}).then((function(t){s([].concat(Object(v.a)(i),[t]))})).catch((function(){return d("Unable to add a todo")})),c("")))},ref:j})]})})},I=function(){var t=Object(o.useContext)(O),e=t.errorMessage,n=t.setErrorMessage,c=!0;""!==e&&(c=!1,setTimeout((function(){n(""),c=!0}),3e3));var r=function(){n(""),c=!0};return Object(p.jsxs)("div",{"data-cy":"ErrorNotification",className:y()("notification","is-danger","is-light","has-text-weight-normal",{hidden:c}),children:[Object(p.jsx)("button",{"data-cy":"HideErrorButton",type:"button",className:"delete",onClick:function(){return r}}),e]})},w=function(){var t=Object(o.useContext)(O),e=t.todos,n=t.errorMessage;return Object(p.jsxs)("div",{className:"todoapp",children:[Object(p.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(p.jsxs)("div",{className:"todoapp__content",children:[Object(p.jsx)(E,{}),0!==e.length&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(N,{}),Object(p.jsx)(C,{})]}),""!==n&&Object(p.jsx)(I,{})]})]})},S=function(){return Object(p.jsx)(h,{children:Object(p.jsx)(w,{})})};Object(r.createRoot)(document.getElementById("root")).render(Object(p.jsx)(S,{}))}},[[22,1,2]]]);
//# sourceMappingURL=main.eebdabd5.chunk.js.map